import{Ma as l,Sa as u,Va as h,o as c,s as d}from"./chunk-E2VDJ7QC.js";import{f as n}from"./chunk-RW4GY4BD.js";var y=(()=>{let a=class a{constructor(){this.firestore=d(l),this.itens=[]}get totalItens(){return this.itens.reduce((t,e)=>t+e.quantidade,0)}get total(){return this.itens.reduce((t,e)=>t+e.total,0)}adicionarItem(t){let e=this.itens.find(i=>i.id===t.id&&JSON.stringify(i.extras)===JSON.stringify(t.extras));e?(e.quantidade+=t.quantidade,e.total=this.calcularTotalItem(e)):(t.total=this.calcularTotalItem(t),this.itens.push(t))}removerItem(t){this.itens=this.itens.filter(e=>e!==t)}limpar(){this.itens=[]}atualizarTotais(){this.itens.forEach(t=>{t.total=this.calcularTotalItem(t)})}calcularTotalItem(t){let e=t.preco||0,i=(t.extras||[]).reduce((o,r)=>o+(r.quantidade||0)*(r.valor||0),0);return e*t.quantidade+i}enviarPedido(t){return n(this,null,function*(){let e={itens:this.itens,total:this.total,totalItens:this.totalItens,status:"pendente",dadosCliente:t,criadoEm:new Date},i=crypto.randomUUID(),o=u(this.firestore,"pedidos",i);return yield h(o,e),this.limpar(),i})}};a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"});let s=a;return s})();export{y as a};
